<?xml version="1.0"?>
<psalm
    stopOnFirstError="false"
    useDocblockTypes="true"
>
    <projectFiles>
        <directory name="src" />
        <directory name="tests/" />
    </projectFiles>

    <fileExtensions>
        <extension name=".php" />
    </fileExtensions>

    <issueHandlers>
        <InvalidArgument>
            <errorLevel type="suppress">
                <!-- Masking errors where we're passing methods that return mixed data into test assertions. -->
                <directory name="tests/" />
            </errorLevel>
        </InvalidArgument>

        <InvalidReturnType>
            <errorLevel type="suppress">
                <!-- Our usage of json_encode() in the Json changelog format is always going to return a string. Not
                    string|false. -->
                <file name="src/Generator/Changelog/Formats/Json.php" />
            </errorLevel>
        </InvalidReturnType>

        <InvalidScalarArgument>
            <errorLevel type="suppress">
                <!-- Masking errors where we're passing methods that return string|bool into test assertions. -->
                <directory name="tests/" />
            </errorLevel>
        </InvalidScalarArgument>

        <MissingClosureReturnType errorLevel="suppress" />
        <MissingConstructor errorLevel="suppress" />

        <MissingReturnType>
            <errorLevel type="suppress">
                <directory name="tests/" />
            </errorLevel>
        </MissingReturnType>

        <PossiblyInvalidArgument>
            <errorLevel type="suppress">
                <!-- Masking errors where we're passing methods that return object|bool into test assertions. -->
                <directory name="tests/" />
            </errorLevel>
        </PossiblyInvalidArgument>

        <!-- This hides a number of errors that we don't really care about. -->
        <PropertyNotSetInConstructor errorLevel="suppress" />

        <!-- Masking PHP 7 errors and warnings for now. Mill will support only PHP 7.1+ in v3. -->
        <UntypedParam errorLevel="suppress" />
    </issueHandlers>
</psalm>
